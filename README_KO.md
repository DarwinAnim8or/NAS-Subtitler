# NAS-Subtitler


<div align="center">

# 🚀 NAS 미디어 라이브러리를 위한 전용 자막 도구.

**Languages:** [English](README.md) | [中文](README_CN.md) | [繁體中文](README_TW.md) | [Deutsch](README_DE.md) | [Español](README_ES.md) | [Français](README_FR.md) | [日本語](README_JA.md) | [한국어](README_KO.md) | [Русский](README_RU.md)

</div>

**자막 작업을 NAS로 되돌리세요｜Make your NAS talk.**

주말 저녁, 당신은 재생만 누르고 싶습니다. NAS-Subtitler는 매핑된 **`/data`** 폴더를 지켜봅니다: 새 비디오 감지 → 오디오를 로컬에서 깔끔하게 분할 → **문맥 인지 번역**과 함께 자동 음성 전사 → 원래 디렉터리에 깔끔한 자막을 다시 작성. 진행 상태를 지켜볼 필요 없고, 미디어가 서버 밖으로 나갈 일도 없습니다.  
이 “당연히 이렇게 동작해야 한다”는 경험은 셀프 호스팅의 정신에서 옵니다 — **로컬 제어, 프라이버시 우선. Your media, your server, your way.**

## ✅ 대상 (전형적인 시나리오)

**NAS (Jellyfin / Plex / Emby)**  

- 관심사: 라이브러리 전체 자동화, 일관된 네이밍, 플러그 앤 플레이  
- 기대: 디렉터리 매핑 → 큐잉 → 동일한 이름의 SRT로 다시 쓰기, 기존 미디어 질서를 방해하지 않음

**프라이버시/컴플라이언스를 중시하는 조직 (법무/의료 교육 등)**  

- 관심사: 로컬 연산, 감사 가능성  
- 기대: 필요 시에만 선택한 호환 엔드포인트로 **최소화된 오디오 세그먼트** 전송

**오픈소스 사용자 및 확장 개발자**  

- 관심사: 교체 가능, 확장 가능  
- 기대: Docker-first, OpenAI 호환 API, 명확한 로드맵, PR 친화적

---

## ✨ 왜 NAS-Subtitler인가 (핵심 요약)

- **로컬 우선 & 프라이버시 친화적**  
NAS에서 **Silero-VAD (ONNX)** 로 “어디서 말하는지”를 감지하고, 오디오를 깔끔하고 가볍게 분할 후, 전사와 번역을 수행 — **전체 비디오는 서버를 떠나지 않습니다**.
- **문맥 인지 번역 경험**  [계획됨]
단절된 “문장별 기계 번역”이 아니라 **의미 윈도우로 병합 → 번역 → 재배치**, 사람 손글씨같이 자연스러운 자막 — 영화와 온라인 강의 모두에 적합합니다.
- **라이브러리 수준 자동화, 가전처럼 신뢰성**  
디렉터리 감시 → 큐 스케줄링 → 실패 시 재시도 → **동일 이름 SRT로 다시 쓰기**, Jellyfin/Plex/Emby 인식 규칙과 자연 호환.
- **다국어 & 이중 언어 출력**  [계획됨]
한 번에 여러 언어 생성; **중–영 병기**(동일 파일 또는 분리 파일) 선택 가능, 학습과 시청에 모두 유용.
- **오픈소스 & Docker-first**  
투명하고 감사 가능; 한 줄 명령으로 서비스 시작; 의존성과 업데이트 리듬 명확. FFmpeg가 A/V 추출과 처리를 담당 — 성숙한 생태계, 플랫폼 간 안정.

---

## 🧩 동작 방식 (How it works)

```
/data (videos)
   └─ Watch  →  FFmpeg로 오디오 추출  →  로컬 Silero-VAD(ONNX)로 슬라이싱
                   └→ 세그먼트 인식(ASR) → whisper-v3 전사 → 문장부호/타임라인 보정 [계획됨]
                   └→ 자막 작성 (SRT / VTT / ASS, 필요에 따라)
Web UI: 작업 시작 / 진행 확인 / 원클릭 취소         DB: 작업 및 설정 영속화
```

- **FFmpeg**: 오디오 추출 / 포맷 처리 (사실상 표준)  
- **Silero-VAD (ONNX)**: 빠르고 가벼우며 정확한 음성 활동 감지 — NAS에 적합  
- **OpenAI 호환 프로토콜**: API 키 또는 엔드포인트를 직접 지정; 비용과 속도 제어

---

## 🚀 빠른 시작 (Docker Compose)

1. **전제**: NAS가 Docker를 지원  
2. **클론 또는 이미지 가져오기**: `git clone ...` (또는 이미지를 직접 가져오기)  
3. **시작**:

```yaml
services:
  nas-subtitler:
    image: ghcr.io/yourname/nas-subtitler:latest
    container_name: nas-subtitler
    environment:
      - TZ=Asia/Shanghai
      - MOUNT_DIR=/data
    volumes:
      - /path/to/videos:/data
      - /path/to/config:/app/data/config
    ports:
      - "3000:3000"
    restart: unless-stopped
```

5. **접속**: `http://<NAS-IP>:3000` 를 열어 Web UI 사용  
6. **설정**: 설정 페이지에서 OpenAI API 키 입력

---

## 🖱️ 사용법 (5분 셋업)

1. **디렉터리 선택**: 비디오 폴더 지정 (예: `/data/Movies`)  
2. **작업 시작**: “Start Processing” 클릭, 전사/번역 대상 언어, 이중 언어 출력 등 선택  
3. **진행 모니터링**: “Tasks” 페이지에서 큐와 상태 확인; 원클릭 취소/재시도 지원  
4. **출력**: 자막은 **비디오와 동일한 폴더**에 생성 (예: `movie.srt` 또는 `movie.zh-en.srt`)  
5. **미디어 서버 인식**: 라이브러리를 재스캔하여 자막 적용 확인

---

## 🧰 기능 개요

- **진정한 오픈소스**: 완전 투명, NAS 로컬 실행으로 데이터 프라이버시 보장  
- **셀프서브 (BYO-Key)**: 직접 소유한 OpenAI API 키로 전사/번역 — **완전 제어**  
- **문맥 인지 번역 [계획됨]**: 의미 윈도우 처리로 일관되고 자연스러운 번역  
- **이중 언어 지원**: 중–영 병기 (동일 파일/분리 파일) 선택 가능  
- **배치 처리**: 영화/시리즈 자막을 원클릭 자동 생성  
- **다국어 지원**: 다국어 인식 개선 및 **문장부호 보정**으로 더 매끄러운 읽기

---

## 🧱 의존성 (엔지니어용)

- **FFmpeg**: A/V 추출 및 처리  
- **Silero-VAD (ONNX)**: 음성 활동 감지 (VAD)  
- **Node.js 및 관련 패키지**: Prisma(DB), EJS(템플릿) 등  
- **OpenAI API (셀프서브)**: 호환 프로토콜을 따르는 엔드포인트는 모두 전환 가능

---

## 🗒️ 변경 기록 (Changelog)

- **v1.0.0**  
  - **배치 작업 동시성 제어** 추가, 처리 더 빠르고 안정적  
  - 다양한 UI 문제와 에지 케이스 오류 수정

> 전체 변경 사항은 Web UI의 “View Changelog”에서 확인하세요.

---

## 🧭 로드맵 (Roadmap)

- [ ] **번역** → 엔드투엔드 전사 + LLM 번역, 실제 유용성 확보
- [ ] **번역 2차 다듬기** → 이미 번역된 자막을 LLM으로 정제
- [ ] **타임라인 최적화** → 자막 타이밍 정렬 개선
- [ ] **경량 동시 인식** → 레이트 제한 병렬 처리로 장편 영상 가속  
- [ ] **웹 미리보기** → 타임라인/파형으로 신속 검증  
- [ ] **더 많은 공급자** → 다양한 벤더 지원

---

## 🤝 기여 & 커뮤니티

기여 환영! 저장소를 포크하고 Pull Request를 제출하세요.  
큰 변경은 먼저 Issue로 논의해 주세요; 플랫폼 템플릿(Synology/Unraid/TrueNAS), 공급자 어댑터, i18n 제공도 환영합니다.

---

## 📝 라이선스

본 프로젝트는 **MIT** 라이선스(저장소 기준)입니다.

---

## 🙏 감사 & 참고

- FFmpeg — 기술적 기반
- Silero-VAD (ONNX)